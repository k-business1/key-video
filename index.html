<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Key Media - Professional Studio</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/lucide-react@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #0a0a0c; color: white; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 10px; }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.08); }
        .gradient-text { background: linear-gradient(to right, #ec4899, #8b5cf6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        const { 
            Heart, Download, Home, Settings, LogOut, 
            Plus, Upload, Trash2, BarChart3, Users, 
            Eye, X, MapPin, Edit3, Search, Play
        } = lucideReact;

        const MediaLibraryApp = () => {
            // --- State Management ---
            const [favorites, setFavorites] = useState([]);
            const [downloads, setDownloads] = useState([]);
            const [activeSection, setActiveSection] = useState('home');
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [appName, setAppName] = useState('Key Media');
            const [showUpload, setShowUpload] = useState(false);
            const [showProfileEdit, setShowProfileEdit] = useState(false);
            
            const [userProfile, setUserProfile] = useState({
                username: 'KeyCreator',
                posts: 0,
                followers: 1250,
                stats: 88,
                bio: 'Professional Digital Media Producer at Key Media.',
                location: 'Kigali, Rwanda',
                avatar: null
            });

            const [loginData, setLoginData] = useState({ username: '', password: '' });

            // --- Persistence (Local Storage) ---
            useEffect(() => {
                const savedFavs = localStorage.getItem('km-favs');
                if (savedFavs) setFavorites(JSON.parse(savedFavs));

                const savedMedia = localStorage.getItem('km-media');
                if (savedMedia) setDownloads(JSON.parse(savedMedia));

                const savedProfile = localStorage.getItem('km-profile');
                if (savedProfile) setUserProfile(JSON.parse(savedProfile));

                const logged = localStorage.getItem('km-auth');
                if (logged === 'true') setIsLoggedIn(true);
            }, []);

            useEffect(() => {
                localStorage.setItem('km-favs', JSON.stringify(favorites));
                localStorage.setItem('km-media', JSON.stringify(downloads));
                localStorage.setItem('km-profile', JSON.stringify(userProfile));
            }, [favorites, downloads, userProfile]);

            // --- Business Logic ---
            const handleLogin = () => {
                if (loginData.username.length >= 3) {
                    setIsLoggedIn(true);
                    localStorage.setItem('km-auth', 'true');
                } else {
                    alert("Injiza izina rifite inyuguti 3 kuzamura");
                }
            };

            const handleLogout = () => {
                setIsLoggedIn(false);
                localStorage.setItem('km-auth', 'false');
            };

            const handleFileUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (ev) => {
                        const newItem = {
                            id: Date.now(),
                            title: file.name.split('.')[0],
                            views: Math.floor(Math.random() * 500) + " views",
                            duration: "HD",
                            thumbnail: ev.target.result,
                            type: file.type.includes('image') ? 'image' : 'video'
                        };
                        setDownloads([newItem, ...downloads]);
                        setUserProfile(prev => ({ ...prev, posts: prev.posts + 1 }));
                        setShowUpload(false);
                    };
                    reader.readAsDataURL(file);
                }
            };

            const toggleFavorite = (item) => {
                setFavorites(prev => 
                    prev.some(f => f.id === item.id) 
                    ? prev.filter(f => f.id !== item.id) 
                    : [...prev, item]
                );
            };

            const deleteMedia = (id) => {
                setDownloads(prev => prev.filter(m => m.id !== id));
                setUserProfile(prev => ({ ...prev, posts: Math.max(0, prev.posts - 1) }));
            };

            // --- UI Components ---
            const MediaCard = ({ item, isLibrary = false }) => (
                <div className="group relative glass rounded-2xl overflow-hidden transition-all hover:scale-[1.02]">
                    <div className="aspect-video relative overflow-hidden">
                        <img src={item.thumbnail} className="w-full h-full object-cover" />
                        <div className="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3">
                            <button onClick={() => toggleFavorite(item)} className={`p-2 rounded-full ${favorites.some(f => f.id === item.id) ? 'bg-pink-600' : 'bg-white/20'} backdrop-blur-md`}>
                                <Heart size={18} fill={favorites.some(f => f.id === item.id) ? 'white' : 'none'} />
                            </button>
                            {isLibrary && (
                                <button onClick={() => deleteMedia(item.id)} className="p-2 bg-red-600/80 rounded-full backdrop-blur-md">
                                    <Trash2 size={18} />
                                </button>
                            )}
                        </div>
                    </div>
                    <div className="p-4">
                        <h4 className="font-semibold truncate text-white/90">{item.title}</h4>
                        <div className="flex justify-between text-xs text-white/40 mt-2 font-medium">
                            <span>{item.views}</span>
                            <span className="bg-white/10 px-2 py-0.5 rounded">{item.duration}</span>
                        </div>
                    </div>
                </div>
            );

            // --- Auth Screen ---
            if (!isLoggedIn) {
                return (
                    <div className="min-h-screen flex items-center justify-center p-6 bg-[radial-gradient(circle_at_top_right,_var(--tw-gradient-stops))] from-indigo-900/20 via-slate-950 to-slate-950">
                        <div className="glass max-w-md w-full p-10 rounded-[40px] shadow-2xl border-white/5">
                            <div className="text-center mb-10">
                                <div className="w-20 h-20 bg-gradient-to-tr from-pink-500 to-violet-600 rounded-3xl flex items-center justify-center text-3xl font-black mx-auto mb-6 shadow-xl shadow-purple-500/20">K</div>
                                <h2 className="text-3xl font-bold mb-2 tracking-tight">Key Media <span className="text-purple-500">Studio</span></h2>
                                <p className="text-white/40">Injira muri studio yawe utangire gukora</p>
                            </div>
                            <div className="space-y-4">
                                <input 
                                    className="w-full bg-white/5 border border-white/10 px-6 py-4 rounded-2xl outline-none focus:ring-2 focus:ring-purple-500 transition-all" 
                                    placeholder="Username" 
                                    onChange={e => setLoginData({...loginData, username: e.target.value})}
                                />
                                <input 
                                    type="password" 
                                    className="w-full bg-white/5 border border-white/10 px-6 py-4 rounded-2xl outline-none focus:ring-2 focus:ring-purple-500 transition-all" 
                                    placeholder="Password" 
                                />
                                <button 
                                    onClick={handleLogin}
                                    className="w-full bg-gradient-to-r from-pink-600 to-violet-600 py-4 rounded-2xl font-bold mt-4 hover:shadow-lg hover:shadow-purple-500/30 transition-all active:scale-95"
                                >
                                    Login Studio
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // --- Main Dashboard ---
            return (
                <div className="min-h-screen flex">
                    {/* Sidebar */}
                    <aside className="w-72 border-r border-white/5 flex flex-col fixed h-full z-20 bg-slate-950/50 backdrop-blur-xl">
                        <div className="p-8 flex items-center gap-3">
                            <div className="w-10 h-10 bg-gradient-to-br from-pink-500 to-purple-600 rounded-xl flex items-center justify-center font-black">K</div>
                            <span className="text-xl font-bold tracking-tighter">Key Media</span>
                        </div>

                        <nav className="flex-1 px-4 space-y-2">
                            {[
                                { id: 'home', icon: Home, label: 'Dashboard' },
                                { id: 'downloads', icon: Download, label: 'Media Library' },
                                { id: 'favorites', icon: Heart, label: 'Favorites' },
                                { id: 'analytics', icon: BarChart3, label: 'Analytics' },
                                { id: 'profile', icon: Users, label: 'My Profile' },
                            ].map(item => (
                                <button 
                                    key={item.id}
                                    onClick={() => setActiveSection(item.id)}
                                    className={`w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all ${activeSection === item.id ? 'glass text-white shadow-lg' : 'text-white/40 hover:text-white hover:bg-white/5'}`}
                                >
                                    <item.icon size={20} />
                                    <span className="font-semibold">{item.label}</span>
                                </button>
                            ))}
                        </nav>

                        <div className="p-6 border-t border-white/5">
                            <button onClick={handleLogout} className="w-full flex items-center gap-4 px-6 py-4 rounded-2xl text-red-400 hover:bg-red-400/10 transition-all">
                                <LogOut size={20} />
                                <span className="font-semibold">Logout</span>
                            </button>
                        </div>
                    </aside>

                    {/* Main Content Area */}
                    <main className="ml-72 flex-1 p-10">
                        <header className="flex justify-between items-center mb-12">
                            <div>
                                <h1 className="text-4xl font-bold capitalize tracking-tight">{activeSection}</h1>
                                <p className="text-white/40 mt-1">Hello, {userProfile.username}. Welcome back to Key Media.</p>
                            </div>
                            <button onClick={() => setShowUpload(true)} className="bg-white text-black px-8 py-4 rounded-2xl font-bold flex items-center gap-2 hover:bg-purple-100 transition-all shadow-xl shadow-white/5">
                                <Plus size={20} /> Upload New
                            </button>
                        </header>

                        {/* Sections */}
                        {activeSection === 'home' && (
                            <div className="space-y-12">
                                <div className="grid grid-cols-3 gap-6">
                                    <div className="glass p-8 rounded-[32px] border-l-4 border-l-pink-500">
                                        <p className="text-white/40 font-medium uppercase text-xs tracking-widest">Total Media</p>
                                        <h3 className="text-4xl font-bold mt-2">{downloads.length}</h3>
                                    </div>
                                    <div className="glass p-8 rounded-[32px] border-l-4 border-l-purple-500">
                                        <p className="text-white/40 font-medium uppercase text-xs tracking-widest">Followers</p>
                                        <h3 className="text-4xl font-bold mt-2">{userProfile.followers.toLocaleString()}</h3>
                                    </div>
                                    <div className="glass p-8 rounded-[32px] border-l-4 border-l-cyan-500">
                                        <p className="text-white/40 font-medium uppercase text-xs tracking-widest">Engagement</p>
                                        <h3 className="text-4xl font-bold mt-2">{userProfile.stats}%</h3>
                                    </div>
                                </div>

                                <section>
                                    <h3 className="text-2xl font-bold mb-6 flex items-center gap-2">
                                        <Play size={24} className="text-pink-500" /> Recent Uploads
                                    </h3>
                                    <div className="grid grid-cols-4 gap-6">
                                        {downloads.slice(0, 4).map(item => <MediaCard key={item.id} item={item} />)}
                                        {downloads.length === 0 && <div className="col-span-4 py-20 text-center glass rounded-3xl text-white/20 border-dashed border-2 border-white/10">No media found</div>}
                                    </div>
                                </section>
                            </div>
                        )}

                        {activeSection === 'downloads' && (
                            <div className="grid grid-cols-4 gap-6">
                                {downloads.map(item => <MediaCard key={item.id} item={item} isLibrary={true} />)}
                            </div>
                        )}

                        {activeSection === 'favorites' && (
                            <div className="grid grid-cols-4 gap-6">
                                {favorites.map(item => <MediaCard key={item.id} item={item} />)}
                                {favorites.length === 0 && <div className="col-span-4 text-center py-20 text-white/20">Urabanza ukande ku mutima ku mafoto/video</div>}
                            </div>
                        )}

                        {activeSection === 'profile' && (
                            <div className="max-w-4xl glass p-12 rounded-[40px] flex gap-12 items-center">
                                <div className="w-48 h-48 rounded-full bg-gradient-to-tr from-pink-500 to-purple-600 p-1">
                                    <div className="w-full h-full rounded-full bg-slate-900 flex items-center justify-center text-6xl font-bold">
                                        {userProfile.username[0]}
                                    </div>
                                </div>
                                <div className="flex-1">
                                    <div className="flex items-center gap-4 mb-4">
                                        <h2 className="text-5xl font-bold">{userProfile.username}</h2>
                                        <span className="bg-purple-500/20 text-purple-400 px-4 py-1 rounded-full text-sm font-bold">PRO</span>
                                    </div>
                                    <p className="text-white/60 text-lg mb-6 leading-relaxed">{userProfile.bio}</p>
                                    <div className="flex gap-4">
                                        <button onClick={() => setShowProfileEdit(true)} className="glass px-6 py-3 rounded-xl flex items-center gap-2 hover:bg-white/10">
                                            <Edit3 size={18} /> Edit Profile
                                        </button>
                                        <div className="flex items-center gap-2 text-white/40 ml-4">
                                            <MapPin size={18} /> {userProfile.location}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>

                    {/* Modals */}
                    {showUpload && (
                        <div className="fixed inset-0 bg-black/90 backdrop-blur-md z-[100] flex items-center justify-center p-6">
                            <div className="glass max-w-xl w-full p-10 rounded-[40px]">
                                <div className="flex justify-between items-center mb-8">
                                    <h3 className="text-2xl font-bold">Upload to Key Media</h3>
                                    <button onClick={() => setShowUpload(false)} className="p-2 hover:bg-white/10 rounded-full transition-all"><X /></button>
                                </div>
                                <label className="flex flex-col items-center justify-center w-full h-72 border-2 border-dashed border-white/10 rounded-[32px] cursor-pointer hover:bg-white/5 hover:border-purple-500/50 transition-all group">
                                    <div className="bg-purple-500/10 p-6 rounded-full mb-4 group-hover:scale-110 transition-all">
                                        <Upload className="text-purple-500" size={40} />
                                    </div>
                                    <p className="text-lg font-medium">Hitamo ifoto cyangwa video</p>
                                    <p className="text-white/40 text-sm mt-2 font-mono">JPG, PNG cyangwa MP4</p>
                                    <input type="file" className="hidden" accept="image/*,video/*" onChange={handleFileUpload} />
                                </label>
                            </div>
                        </div>
                    )}

                    {showProfileEdit && (
                        <div className="fixed inset-0 bg-black/90 backdrop-blur-md z-[100] flex items-center justify-center p-6">
                            <div className="glass max-w-md w-full p-10 rounded-[40px]">
                                <h3 className="text-2xl font-bold mb-8">Edit Key Media Profile</h3>
                                <div className="space-y-6">
                                    <div>
                                        <label className="text-xs font-bold text-white/40 uppercase tracking-widest ml-1">Studio Name</label>
                                        <input 
                                            className="w-full bg-white/5 border border-white/10 px-6 py-4 rounded-2xl mt-2 outline-none focus:ring-2 focus:ring-purple-500" 
                                            defaultValue={userProfile.username}
                                            onChange={e => setUserProfile({...userProfile, username: e.target.value})}
                                        />
                                    </div>
                                    <div>
                                        <label className="text-xs font-bold text-white/40 uppercase tracking-widest ml-1">Bio</label>
                                        <textarea 
                                            className="w-full bg-white/5 border border-white/10 px-6 py-4 rounded-2xl mt-2 outline-none h-32 focus:ring-2 focus:ring-purple-500" 
                                            defaultValue={userProfile.bio}
                                            onChange={e => setUserProfile({...userProfile, bio: e.target.value})}
                                        />
                                    </div>
                                    <button onClick={() => setShowProfileEdit(false)} className="w-full bg-white text-black py-4 rounded-2xl font-bold text-lg shadow-lg hover:bg-purple-50 transition-all">Save Changes</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MediaLibraryApp />);
    </script>
</body>
</html>
